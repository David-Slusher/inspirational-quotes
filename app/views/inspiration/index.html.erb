<%= javascript_include_tag "inspiration" %>

<div>
	<div id="cycle-image" class="shadow">
	  <div id="display-text">
		  	May The Force Be With You!
		  	<br><br>
		  	 - STAR WARS
	  </div> 
	</div>
</div>

<style type="text/css">
	#cycle-image {
		background-color: #9ab4ed;
		background-size: cover;
		background-position: center center;
		background-repeat: no-repeat;
		transform: translate3d(0,0,0);
		transition: background-image 1s ease-in-out;
		height: 100vh;
		width: 100vw;
	}

	#display-text {
		text-align: center;
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		color: white;
		font-size: 30px;
		font-family: sans-serif;
		font-weight: bold;
		line-height: 30px;
	}
</style>

<script type="text/javascript">
	var b = document.getElementById("body");
  b.style.margin = 0;
  var stock_image = 'http://wallpaper-gallery.net/images/bing-wallpapers/bing-wallpapers-4.jpg';
  var images_url = [stock_image];
	carousel();

	function carousel() {
		if (images_url.length <= 1) {
			fetch_images();
		}
    var x = document.getElementById("cycle-image");
    var lg = "linear-gradient(rgba(0, 0, 0, 0.5),rgba(0, 0, 0, 0.5)), "
    x.style.backgroundImage = lg + "url('" + images_url.pop() + "')";

    x = document.getElementById("display-text");

    // do ajax call to backend to fetch next quote
    $.ajax({
    	method: "GET",
    	url: "<%= inspiration_random_quote_path %>",
    	data: {},
    	dataType: 'JSON'
    }).success(function(json){
	    x.innerHTML = json.quote + "<br><br> - " + json.author;
	    setTimeout(carousel, parseInt("<%= ENV['SLIDESHOW_TIMER_IN_SEC'] %>000")); // Change image every 5 seconds
    });
	}

	function fetch_images(){
		$.ajax({
    	method: "GET",
    	url: "<%= inspiration_fetch_images_path %>",
    	data: {},
    	dataType: 'JSON'
    }).success(function(json){
    	if (json.length == 0) {
    		images_url = images_url.push(stock_image);
    	} else {
    		images_url = images_url.concat(json);
    	}
    }).error(function(xhr, textStatus, error){
    	console.log(xhr.statusText);
      console.log(textStatus);
      console.log(error);
    });
	}
</script>